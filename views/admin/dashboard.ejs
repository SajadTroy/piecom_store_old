<link rel="stylesheet" href="/cdn/css/admin.css">

<div class="admin-container">
    <div class="analytics-grid">
        <div class="analytics-card">
            <div class="analytics-icon orders">
                <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24">
                    <path d='m12 21 8.131-4.208c.316-.164.474-.245.589-.366a1 1 0 0 0 .226-.373c.054-.159.054-.336.054-.692V7.533'/>
                </svg>
            </div>
            <div class="analytics-info">
                <h3>Total Orders</h3>
                <p class="analytics-value"><%= totalOrders %></p>
                <p class="analytics-change positive">+12.5% from last month</p>
            </div>
        </div>

        <div class="analytics-card">
            <div class="analytics-icon revenue">
                <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24">
                    <path d='M12 21a9 9 0 1 0 0-18 9 9 0 0 0 0 18m-4.5-4.5h9M12 12V6'/>
                </svg>
            </div>
            <div class="analytics-info">
                <h3>Total Revenue</h3>
                <p class="analytics-value">₹<%= totalRevenue %></p>
                <p class="analytics-change positive">+8.2% from last month</p>
            </div>
        </div>

        <div class="analytics-card">
            <div class="analytics-icon users">
                <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24">
                    <path d='M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0m-7.5-2.75a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0m3 10.25c-.317-6.187-9.683-6.187-10 0'/>
                </svg>
            </div>
            <div class="analytics-info">
                <h3>Total Users</h3>
                <p class="analytics-value"><%= totalUsers %></p>
                <p class="analytics-change positive">+5.8% from last month</p>
            </div>
        </div>

        <div class="analytics-card">
            <div class="analytics-icon products">
                <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24">
                    <path d='M17 3H7a1 1 0 0 0-1 1v16a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V4a1 1 0 0 0-1-1'/>
                </svg>
            </div>
            <div class="analytics-info">
                <h3>Total Products</h3>
                <p class="analytics-value"><%= totalProducts %></p>
                <p class="analytics-change negative">-2.3% from last month</p>
            </div>
        </div>
    </div>

    <div class="charts-grid">
        <div class="chart-card">
            <h3>Monthly Revenue</h3>
            <div class="chart-container">
                <canvas id="revenueChart"></canvas>
            </div>
        </div>
        
        <div class="chart-card">
            <h3>Orders Status</h3>
            <div class="chart-container">
                <canvas id="ordersChart"></canvas>
            </div>
        </div>
    </div>

    <div class="recent-section">
        <h3>Recent Orders</h3>
        <div class="table-container">
            <table class="admin-table">
                <thead>
                    <tr>
                        <th>Order ID</th>
                        <th>Customer</th>
                        <th>Status</th>
                        <th>Amount</th>
                        <th>Date</th>
                    </tr>
                </thead>
                <tbody>
                    <% recentOrders.forEach(order => { %>
                    <tr>
                        <td>#<%= order._id.slice(-6) %></td>
                        <td><%= order.customer %></td>
                        <td><span class="status <%= order.status.toLowerCase() %>"><%= order.status %></span></td>
                        <td>₹<%= order.amount %></td>
                        <td><%= new Date(order.date).toLocaleDateString() %></td>
                    </tr>
                    <% }) %>
                </tbody>
            </table>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    // Revenue Chart
    const revenueCtx = document.getElementById('revenueChart').getContext('2d');
    new Chart(revenueCtx, {
        type: 'line',
        data: {
            labels: <%= JSON.stringify(monthLabels) %>,
            datasets: [{
                label: 'Revenue',
                data: <%= JSON.stringify(revenueData) %>,
                borderColor: '#333',
                tension: 0.4
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false
        }
    });

    // Orders Chart
    const ordersCtx = document.getElementById('ordersChart').getContext('2d');
    new Chart(ordersCtx, {
        type: 'doughnut',
        data: {
            labels: ['Delivered', 'Pending', 'Processing'],
            datasets: [{
                data: <%= JSON.stringify(orderStatusData) %>,
                backgroundColor: ['#00aa69', '#ff9800', '#2196f3']
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false
        }
    });
</script>
